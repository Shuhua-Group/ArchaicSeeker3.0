2025-07-15 01:01:52,467 [INFO ]  ======================================================
2025-07-15 01:01:52,467 [INFO ]                 ArchaicSeeker 3.1 Mamba Started              
2025-07-15 01:01:52,467 [INFO ]  ======================================================
2025-07-15 01:01:52,467 [INFO ]  All logs will be saved to: examples/aseeker3_results_20250715/chr22/run.log
2025-07-15 01:01:52,467 [INFO ]  Checking for existence of required input files...
2025-07-15 01:01:52,471 [INFO ]  All required files found.
2025-07-15 01:01:52,472 [INFO ]  Loading base model arguments from: /home/pogadmin/ArchaicSeeker3/ArchaicSeeker3.1-Mamba/exp/Basemodel_Mamba_4096/args.pckl
2025-07-15 01:01:52,473 [INFO ]  Loading smoother model arguments from: /home/pogadmin/ArchaicSeeker3/ArchaicSeeker3.1-Mamba/exp/Smoother_4096_512_Kernel_4096/args.pckl
2025-07-15 01:01:52,474 [INFO ]  Base model args loaded: {'exp': 'exp/basemodel_pretrain_winsize500_mamba_20250417/', 'train_mixed': 'vcf/train_4cate/', 'valid_mixed': 'vcf/test_4cate/', 'train_ref_panel': 'vcf/REF_4cate/', 'valid_ref_panel': 'vcf/REF_4cate/', 'query': False, 'reference': False, 'map': False, 'num_epochs': 99999999, 'batch_size': 1, 'lr': 1e-05, 'lr_decay': -1, 'update_every': 1, 'smoother': 'anc1conv', 'ref_pooling': 'topk-average', 'topk_k': 1, 'win_size': 4096, 'win_stride': 512, 'dropout': -1, 'loss': 'FC', 'resume': True, 'validate': False, 'n_refs': 99999, 'comment': None, 'initial': False}
2025-07-15 01:01:52,475 [INFO ]  Smoother model args loaded: {'exp': 'exp/Smoother_Only_MambaBased_4096_512_Kernel_4096_V4_20250514_lr1e5/', 'train_mixed': 'vcf/train_4cate/', 'valid_mixed': 'vcf/test_4cate/', 'train_ref_panel': 'vcf/REF_4cate/', 'valid_ref_panel': 'vcf/REF_4cate/', 'query': False, 'reference': False, 'map': False, 'num_epochs': 99999999, 'batch_size': 1, 'lr': 1e-05, 'lr_decay': -1, 'update_every': 1, 'smoother': 'anc1conv', 'ref_pooling': 'topk-average', 'topk_k': 1, 'win_size': 4096, 'win_stride': 512, 'dropout': -1, 'loss': 'FC', 'resume': False, 'validate': False, 'n_refs': 99999, 'comment': None, 'inference_pt': '/cpfs01/projects-HDD/humPOG_HDD/public/leichang/ArchaicSim/00_BaseModel_Pretrain_InferData/00_Mamba_Win4096_Stride512_allData_Train_20250427_Latest/', 'inference_val_pt': '/cpfs01/projects-HDD/humPOG_HDD/public/leichang/ArchaicSim/00_BaseModel_Pretrain_InferData/00_Mamba_Win4096_Stride512_allData_Val_20250427_latest/', 'inference_val_small_pt': '/cpfs01/projects-HDD/humPOG_HDD/public/leichang/ArchaicSim/00_BaseModel_Pretrain_InferData/00_Mamba_Win4096_Stride512_allData_Val_20250427_latest/valid_loaders_small/'}
2025-07-15 01:01:52,513 [INFO ]  Using device: cuda
2025-07-15 01:01:52,513 [INFO ]  CUDA_VISIBLE_DEVICES: 1
2025-07-15 01:01:52,513 [INFO ]  Loading BaseModel...
2025-07-15 01:01:53,061 [INFO ]  Loading SmootherModel...
2025-07-15 01:01:53,084 [INFO ]  All models loaded successfully.
2025-07-15 01:01:53,084 [INFO ]  Reading sample list from target VCF: examples/raw_data_preprocessed_output/Final_Target_VCFs/target_panel.chr22.vcf.gz
2025-07-15 01:01:53,094 [INFO ]  Creating complete haplotype ID to sample name map...
2025-07-15 01:01:53,095 [INFO ]  Total target samples: 103. Processing in 1 chunk(s) of size 103.
2025-07-15 01:01:53,101 [INFO ]  --- Processing Chunk 1/1 (Samples 1 to 103) ---
2025-07-15 01:01:53,101 [INFO ]  Initializing new Dataset chunk...
2025-07-15 01:01:53,101 [INFO ]  Loading reference panel...
2025-07-15 01:01:53,311 [INFO ]  Reading positions from target VCF...
2025-07-15 01:01:53,421 [INFO ]  Finding intersection of SNPs between reference and target...
2025-07-15 01:01:53,423 [INFO ]  Found 29095 common SNPs. Aligning data...
2025-07-15 01:01:53,426 [INFO ]  Loading and aligning genotype data for 103 target samples...
2025-07-15 01:01:53,756 [INFO ]  Dataset chunk for samples ['NA18525', 'NA18526', 'NA18528', 'NA18530', 'NA18531', 'NA18532', 'NA18533', 'NA18534', 'NA18535', 'NA18536', 'NA18537', 'NA18538', 'NA18539', 'NA18541', 'NA18542', 'NA18543', 'NA18544', 'NA18545', 'NA18546', 'NA18547', 'NA18548', 'NA18549', 'NA18550', 'NA18552', 'NA18553', 'NA18555', 'NA18557', 'NA18558', 'NA18559', 'NA18560', 'NA18561', 'NA18562', 'NA18563', 'NA18564', 'NA18565', 'NA18566', 'NA18567', 'NA18570', 'NA18571', 'NA18572', 'NA18573', 'NA18574', 'NA18577', 'NA18579', 'NA18582', 'NA18591', 'NA18592', 'NA18593', 'NA18595', 'NA18596', 'NA18597', 'NA18599', 'NA18602', 'NA18603', 'NA18605', 'NA18606', 'NA18608', 'NA18609', 'NA18610', 'NA18611', 'NA18612', 'NA18613', 'NA18614', 'NA18615', 'NA18616', 'NA18617', 'NA18618', 'NA18619', 'NA18620', 'NA18621', 'NA18622', 'NA18623', 'NA18624', 'NA18625', 'NA18626', 'NA18627', 'NA18628', 'NA18629', 'NA18630', 'NA18631', 'NA18632', 'NA18633', 'NA18634', 'NA18635', 'NA18636', 'NA18637', 'NA18638', 'NA18639', 'NA18640', 'NA18641', 'NA18642', 'NA18643', 'NA18644', 'NA18645', 'NA18646', 'NA18647', 'NA18648', 'NA18740', 'NA18745', 'NA18747', 'NA18748', 'NA18749', 'NA18757'] is ready.
2025-07-15 01:03:58,416 [INFO ]  All chunks processed successfully.
2025-07-15 01:03:58,416 [INFO ]  Final output files are located in: examples/aseeker3_results_20250715/chr22
2025-07-15 01:03:58,417 [INFO ]  ======================================================
2025-07-15 01:03:58,417 [INFO ]        Application finished in 0:02:05      
2025-07-15 01:03:58,417 [INFO ]  ======================================================
